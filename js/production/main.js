/*! red-bus-test 0.4.5 */
!function(){var a=function(){var a=this,b={};this.localStorageFlag=!1;var c=function(){var a="redbus";try{return localStorage.setItem(a,a),localStorage.removeItem(a),!0}catch(b){return!1}};this.trimWhiteSpaces=function(a){return a.replace(/^\s+|\s+$/gm,"")},this.getComments=function(){return b=JSON.parse(localStorage.getItem("theBigAppleComments"))||{}},this.getCommentById=function(a){return b[a]},this.getCommentByTitle=function(a){var c=[];for(var d in b)b[d].title.toLowerCase()===a.toLowerCase()&&c.push(b[d]);return c},this.searchCommentsByTitle=function(){},this.addComment=function(c,d){var e=(new Date).getTime(),f={id:e,title:c,body:d};return b[e]=f,localStorage.setItem("theBigAppleComments",JSON.stringify(b)),a.generateComment(f),this.getComments()},this.updateComment=function(a,c,d){var e={id:a,title:c,body:d},f=document.getElementById(a);return b[a]=e,localStorage.setItem("theBigAppleComments",JSON.stringify(b)),f.querySelector(".comment-title").innerText=c,f.querySelector(".comment-desc").innerText=d,this.getComments()},this.deleteComment=function(a){var c=document.getElementById(a);return delete b[a],localStorage.setItem("theBigAppleComments",JSON.stringify(b)),c.parentNode.removeChild(c),this.getComments()},this.generateComment=function(b){var c=document.getElementById("rb-comments"),d=document.getElementById("comment-template").children[0].cloneNode(!0);d.id=b.id,d.querySelector(".comment-title").innerText=b.title,d.querySelector(".comment-desc").innerText=b.body,d.querySelector(".comment-delete").addEventListener("click",function(c){c.preventDefault(),a.createDeleteCommentModal(b.id)}),c.appendChild(d)},this.prepopulateComments=function(){for(var c in b)"object"==typeof b[c]&&a.generateComment(b[c])},this.createDeleteCommentModal=function(b){var c=document.getElementsByTagName("body")[0],d=document.getElementById("comment-delete-template").children[0].cloneNode(!0),e=document.getElementById("comment-delete-template").children[1].cloneNode(!0),f=function(){c.removeChild(d),c.removeChild(e)};e.addEventListener("click",function(){f()}),d.querySelector(".comment-delete-no").addEventListener("click",function(a){a.preventDefault(),f()}),d.querySelector(".comment-delete-yes").addEventListener("click",function(c){c.preventDefault(),a.deleteComment(b),f()}),c.appendChild(e),c.appendChild(d)},this.createErrorMessage=function(a,b){var c=document.createElement("div");return c.className="rb-form-error",c.innerHTML="<strong>"+a+"</strong>"+b,c};var d=function(){return a.localStorage=c(),a.getComments(),a.prepopulateComments(),a};return d()};RB.Utils=new a}(),function(){RB.Form={},RB.Form.errorHolder=document.getElementById("rb-form-error-holder"),RB.Form.commentTitleInput=document.getElementsByClassName("rb-form-comment-title")[0],RB.Form.commentBodyInput=document.getElementsByClassName("rb-form-comment-body")[0],document.getElementsByTagName("html")[0].className=document.getElementsByTagName("html")[0].className.replace("no-js",""),document.getElementsByClassName("rb-form-comment-submit")[0].addEventListener("click",function(a){a.preventDefault();var b=RB.Form.commentTitleInput.value,c=RB.Form.commentBodyInput.value;""!==RB.Utils.trimWhiteSpaces(b)&&""!==RB.Utils.trimWhiteSpaces(c)?RB.Utils.getCommentByTitle(b).length?(RB.Form.errorHolder.childNodes.length&&RB.Form.errorHolder.removeChild(RB.Form.errorHolder.childNodes[0]),RB.Form.errorHolder.appendChild(RB.Utils.createErrorMessage("Oops!!","Seems like the comment title already exists. Please enter a different title.")),RB.Form.commentTitleInput.value=""):(RB.Form.errorHolder.childNodes.length&&RB.Form.errorHolder.removeChild(RB.Form.errorHolder.childNodes[0]),RB.Utils.addComment(b,c),RB.Form.commentTitleInput.value="",RB.Form.commentBodyInput.value=""):(RB.Form.errorHolder.childNodes.length&&RB.Form.errorHolder.removeChild(RB.Form.errorHolder.childNodes[0]),RB.Form.errorHolder.appendChild(RB.Utils.createErrorMessage("Oops!!","Seems like you haven't entered the tile or the description.")))})}();